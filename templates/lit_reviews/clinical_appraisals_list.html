{% extends 'base_lit_reviews.html' %} {% load static %} {% load template_filters
%} {% block 'head' %}
<link
  href="{% static 'css/theme/extractions.css' %}"
  rel="stylesheet"
  type="text/css"
/>
<link
  href="{% static 'css/theme/articles_list.css' %}"
  rel="stylesheet"
  type="text/css"
/>
<link
  href="{% static 'css/theme/clinical_literature_appraisal_list.css' %}"
  rel="stylesheet"
  type="text/css"
/>
{% endblock %} {% block 'help_section' %}
<a
  href="https://citemed-io.gitbook.io/citemed.io-documentation/full-text-review-extraction/2nd-pass-extractions-page"
  target="_blank"
>
  <span
    >Need help with this page? <br />
    Read the Wiki</span
  >
  <div>
    <img src="{% static 'images/icons/wiki-icon.svg' %}" />
  </div>
</a>
{% endblock %} {% block 'body' %}

<div id="appraisals" v-cloak>
  <div v-if="sharedState.prismaStatus === 'RUNNING'">
    <toast
      id="prisma-deduplication-warning"
      ref="prisma-deduplication-warning"
      ref=""
      title="Deduplication is running"
      type="warning"
      :hidden="false"
    >
      <div style="font-size: 16; width: 400px">
        Deduplication is still running, please don't start your review until
        it's completed. This process can take a few minutes, you can also check
        the prisma status on the bottom of the page.
      </div>
    </toast>
  </div>

  <div class="appraisals-wrapper">

    <div class="appraisals-list">
      <toast
        v-if="appraisalsInsights && appraisalsInsights.Total > maxResults"
        id="max-results-toast"
        ref="max-results-toast"
        title="Search Results Warning"
        type="warning"
        expires="100000"
        :hidden="false"
      >
        <p>
          The max results that should be included in this project are
          [[max_results]], but you currently have
          [[appraisalsInsights.Total]] which is exceeding the maximum
          please contact PM to discuss this before you start 2nd pass screening.
          <br />
          Still stuck? Get instant help from our team by submitting a ticket
          <a
            href="https://share.hsforms.com/1jqB4CJx9RxyvGL3qQYo2rgcq0hk"
            target="_blank"
          >
            HERE.</a
          >
        </p>
        <button
          class="secondary-gray-button mt"
          v-on:click="hideToast('max-results-toast')"
        >
          Ok, I Understand
        </button>
      </toast>

      <div class="center-v" style="justify-content: space-between">
        <h3 class="center-v">
          Clinical Literature Appraisals
          <div class="tooltip" style="padding-left: 10px">
            <a
              class="help-button warning"
              href="https://citemed-io.gitbook.io/citemed.io-documentation/full-text-review-extraction/2nd-pass-extractions-page"
              target="_blank"
            >
              <span>What do I do on this page?</span>
            </a>
          </div>
        </h3>
        <div class="center-v">
          <div class="center-v">
            Total Articles:
            <div v-if="appraisalsInsights" class="badge secondary ml" style="border-radius: 5px">
              [[appraisalsInsights.Total]]
            </div>
          </div>
          <button
            class="secondary-gray-button ml"
            id="validate-search-btn"
            v-on:click="onOpenUploadOwnCitationsModal"
            :disabled="isArchived"
          >
            <div class="center-v">
              <!-- <svg class="mr" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
            <path d="M7.04898 11.6323H2.8007C2.0275 11.6323 1.4007 11.0055 1.4007 10.2322L1.40076 4.90974C1.40076 4.37661 1.40056 3.61727 1.40039 3.06745C1.40027 2.68075 1.71372 2.36763 2.10042 2.36763H5.43604L7.04898 4.09058H11.9002C12.2868 4.09058 12.6002 4.40399 12.6002 4.79058V6.65M11.5502 10.85L12.2502 11.55M11.9002 9.45C11.9002 10.4165 11.1167 11.2 10.1502 11.2C9.18366 11.2 8.40016 10.4165 8.40016 9.45C8.40016 8.4835 9.18366 7.7 10.1502 7.7C11.1167 7.7 11.9002 8.4835 11.9002 9.45Z" stroke="#181A1E" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg> -->
              <img
                src="{% static 'images/icons/download-icon-gray.png' %}"
                class="mr"
                alt="download-icon"
                style="width: 15px"
              />
              Import Your Own Citations
            </div>
          </button>
        </div>
      </div>

      <div class="filters">
        <div class="search-section">
          <form id="search-form" v-on:submit="onTitleSearch">
            <input
              v-model="searchTerm"
              type="search"
              placeholder="Search For Articles by Title, Abstract ...etc"
              name="search_title"
              id="search_title"
            />
            <button type="submit" class="search-button">
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M9.0625 3.125C5.78331 3.125 3.125 5.78331 3.125 9.0625C3.125 12.3417 5.78331 15 9.0625 15C12.3417 15 15 12.3417 15 9.0625C15 5.78331 12.3417 3.125 9.0625 3.125ZM1.875 9.0625C1.875 5.09295 5.09295 1.875 9.0625 1.875C13.032 1.875 16.25 5.09295 16.25 9.0625C16.25 13.032 13.032 16.25 9.0625 16.25C5.09295 16.25 1.875 13.032 1.875 9.0625Z"
                  fill="#9BA5B9"
                />
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M13.2611 13.2612C13.5051 13.0171 13.9009 13.0171 14.1449 13.2612L17.9418 17.0581C18.1859 17.3022 18.1859 17.6979 17.9418 17.942C17.6977 18.1861 17.302 18.1861 17.0579 17.942L13.2611 14.1451C13.017 13.901 13.017 13.5053 13.2611 13.2612Z"
                  fill="#9BA5B9"
                />
              </svg>
            </button>
          </form>
        </div>

        <!-- Filters -->
        <div class="filter-button ml" v-on:click="showModal('filter-slider')">
          <div v-if="isFilterApplied" class="filter-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 16 16"
              fill="none"
            >
              <path
                d="M3.6 1.40002H12.4C13.1333 1.40002 13.7333 2.00002 13.7333 2.73336V4.20002C13.7333 4.73336 13.4 5.40002 13.0667 5.73336L10.2 8.26669C9.8 8.60002 9.53333 9.26669 9.53333 9.80002V12.6667C9.53333 13.0667 9.26666 13.6 8.93333 13.8L8 14.4C7.13333 14.9334 5.93333 14.3334 5.93333 13.2667V9.73336C5.93333 9.26669 5.66666 8.66669 5.4 8.33336L2.86666 5.66669C2.53333 5.33336 2.26666 4.73336 2.26666 4.33336V2.80002C2.26666 2.00002 2.86666 1.40002 3.6 1.40002Z"
                stroke="#292D32"
                stroke-width="1.5"
                stroke-miterlimit="10"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            <svg
              class="filter-applied"
              xmlns="http://www.w3.org/2000/svg"
              width="6"
              height="6"
              viewBox="0 0 6 6"
              fill="none"
            >
              <circle cx="3" cy="3" r="2.5" fill="#F7154B" stroke="white" />
            </svg>
          </div>
          <svg
            v-else
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            viewBox="0 0 16 16"
            fill="none"
          >
            <path
              d="M3.6 1.4H12.4C13.1333 1.4 13.7333 2 13.7333 2.73333V4.2C13.7333 4.73334 13.4 5.4 13.0667 5.73334L10.2 8.26667C9.8 8.6 9.53333 9.26667 9.53333 9.8V12.6667C9.53333 13.0667 9.26666 13.6 8.93333 13.8L8 14.4C7.13333 14.9333 5.93333 14.3333 5.93333 13.2667V9.73334C5.93333 9.26667 5.66666 8.66667 5.4 8.33333L2.86666 5.66667C2.53333 5.33334 2.26666 4.73334 2.26666 4.33334V2.8C2.26666 2 2.86666 1.4 3.6 1.4Z"
              stroke="#292D32"
              stroke-width="1.5"
              stroke-miterlimit="10"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          Filter Results
        </div>

        <div class="slider" id="filter-slider">
          <div class="slider-dialog">
            <div class="slider-dialog-inner">
              <div class="slider-header">
                <button
                  class="pagintaion-item mr"
                  v-on:click="hideModal('filter-slider')"
                >
                  <svg
                    width="16"
                    height="16"
                    viewBox="0 0 16 16"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M10.0002 13.28L5.65355 8.93333C5.14022 8.42 5.14022 7.58 5.65355 7.06667L10.0002 2.72"
                      stroke="#292D32"
                      stroke-width="1.5"
                      stroke-miterlimit="10"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </button>
                Filters
              </div>

              <div class="slider-content">
                <div class="filter-section">
                  <div class="header">IS SOTA</div>
                  <div class="filter-selects">
                    <div
                      v-on:click="onIsSotaFilterChanged(null)"
                      class="filter-select"
                      :class="isSotaFilter === null ? 'selected' : ''"
                    >
                      <input
                        type="radio"
                        id="sota_all"
                        name="filter_is_sota"
                        :value="null"
                        :checked="isSotaFilter === null"
                      />
                      <label for="sota_all"> All </label>
                    </div>
                    <div
                      v-on:click="onIsSotaFilterChanged(true)"
                      :class="isSotaFilter === true ? 'selected' : ''"
                      class="filter-select"
                    >
                      <input
                        type="radio"
                        id="sota_true"
                        name="filter_is_sota"
                        :value="true"
                        :checked="isSotaFilter === true"
                      />
                      <label for="sota_true">True</label>
                    </div>

                    <div
                      v-on:click="onIsSotaFilterChanged(false)"
                      :class="isSotaFilter === false ? 'selected' : ''"
                      class="filter-select"
                    >
                      <input
                        type="radio"
                        id="sota_false"
                        name="filter_is_sota"
                        :value="false"
                        :checked="isSotaFilter === false"
                      />
                      <label for="sota_false">False </label>
                    </div>
                  </div>
                </div>

                <div class="horizantal-devider"></div>

                <div class="filter-section">
                  <div class="header">STATUS</div>
                </div>

                <div class="filter-section">
                  <h3 class="">Completed</h3>
                  <div
                    class="filter-check"
                    v-for="item in statusFilterCompleOptions"
                  >
                    <label :for="item.value"> [[item.name]] </label>
                    <input
                      v-model="statusFilter"
                      type="checkbox"
                      name="filter_status"
                      :value="item.value"
                      :id="item.value"
                    />
                  </div>
                </div>

                <div class="horizantal-devider"></div>

                <div class="filter-section">
                  <h3 class="">Uncompleted</h3>

                  <div
                    class="filter-check"
                    v-for="item in statusFilterUncompleteOptions"
                  >
                    <label :for="item.value"> [[item.name]] </label>
                    <input
                      v-model="statusFilter"
                      type="checkbox"
                      name="filter_status"
                      :value="item.value"
                      :id="item.value"
                    />
                  </div>
                </div>
              </div>

              <div class="slider-footer">
                <input
                  v-on:click="onApplyFilters"
                  type="button"
                  value="Filter Results"
                  id="filter-submit"
                  class="primary-button"
                />
              </div>
            </div>
          </div>
        </div>

        <button
          v-if="isFilterApplied || searchTerm"
          v-on:click="onClearFilters"
          class="filter-button ml"
          id="clear-filters"
        >
          <svg
            width="16"
            height="16"
            viewBox="0 0 16 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M14 3.98665C11.78 3.76665 9.54667 3.65332 7.32 3.65332C6 3.65332 4.68 3.71999 3.36 3.85332L2 3.98665"
              stroke="#292D32"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M5.6665 3.31331L5.81317 2.43998C5.91984 1.80665 5.99984 1.33331 7.1265 1.33331H8.87317C9.99984 1.33331 10.0865 1.83331 10.1865 2.44665L10.3332 3.31331"
              stroke="#292D32"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M12.5664 6.09332L12.1331 12.8067C12.0598 13.8533 11.9998 14.6667 10.1398 14.6667H5.85977C3.99977 14.6667 3.93977 13.8533 3.86644 12.8067L3.43311 6.09332"
              stroke="#292D32"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M6.88672 11H9.10672"
              stroke="#292D32"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M6.3335 8.33331H9.66683"
              stroke="#292D32"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
          Clear Filters
        </button>

        <button
          type="button"
          class="secondary-gray-button ml"
          v-on:click="showModal('createManualAppraisal')"
          :disabled="isArchived"
        >
          Create Manual Appraisal
        </button>

        <!-- Create New Appraisal Modal -->
        <div class="modal" id="createManualAppraisal">
          <div class="modal-dialog-creation" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <div class="modal-header-icon-wrapper info-icon">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="25"
                    viewBox="0 0 24 25"
                    fill="none"
                  >
                    <path
                      d="M15.3754 12.4995H12.0004M12.0004 12.4995H8.62537M12.0004 12.4995V15.8744M12.0004 12.4995L12.0004 9.12447M21 6.87498L21 18.125C21 19.989 19.489 21.5 17.625 21.5H6.375C4.51104 21.5 3 19.989 3 18.125V6.87498C3 5.01103 4.51104 3.5 6.375 3.5H17.625C19.489 3.5 21 5.01103 21 6.87498Z"
                      stroke="#014EE9"
                      stroke-width="1.2"
                      stroke-linecap="round"
                    />
                  </svg>
                </div>
                Create Manual Appraisal
              </div>
              <div class="select-creation-method">
                <label for="database-select" class="form-label"
                  >Creation Method</label
                >
                <select
                  name="database"
                  class="form-control method-select-section"
                  v-model="manualCreationMethod"
                  id="database-select"
                >
                  <option value="">Select a Method</option>
                  <option value="new">Create New Appraisal</option>
                  <option value="select-previous">
                    Import From Previous Project
                  </option>
                </select>
              </div>
              <div class="horizantal-devider mb-2 mt-2"></div>
              <form
                v-on:submit="onCreateManualAppraisal"
                method="post"
                enctype="multipart/form-data"
                v-if="manualCreationMethod == 'new'"
              >
                <div class="modal-body">
                  <div class="hint">
                    Please fill the information below to create a new appraisal
                  </div>
                  <div class="form-two">
                    <div class="form-two-col">
                      <label for="article-title" class="form-label"
                        >Title</label
                      >
                      <textarea
                        v-model="createManualAppraisalForm.title"
                        name="title"
                        class="form-control"
                        id="article-title"
                        rows="2"
                        spellcheck="false"
                      ></textarea>
                    </div>
                    <div class="form-two-col">
                      <label for="abstract" class="form-label">Abstract</label>
                      <textarea
                        v-model="createManualAppraisalForm.abstract"
                        name="abstract"
                        class="form-control"
                        id="abstract"
                        rows="2"
                        spellcheck="false"
                      ></textarea>
                    </div>
                  </div>
                  <div>
                    <label for="citation" class="form-label">Citation</label>
                    <textarea
                      v-model="createManualAppraisalForm.citation"
                      name="citation"
                      class="form-control"
                      id="citation"
                      rows="2"
                      spellcheck="false"
                    ></textarea>
                  </div>
                  <div class="form-two">
                    <div class="form-two-col">
                      <label for="pubmed_uid" class="form-label"
                        >Pubmed Uid</label
                      >
                      <input
                        v-model="createManualAppraisalForm.pubmed_uid"
                        name="pubmed_uid"
                        type="text"
                        class="form-control"
                        id="pubmed_uid"
                      />
                    </div>
                    <div class="form-two-col">
                      <label for="pmc_uid" class="form-label">PMC Uid</label>
                      <input
                        v-model="createManualAppraisalForm.pmc_uid"
                        name="pmc_uid"
                        type="text"
                        class="form-control"
                        id="pmc_uid"
                      />
                    </div>
                  </div>
                  <div class="form-two">
                    <div class="form-two-col">
                      <label for="doi" class="form-label">DOI</label>
                      <input
                        v-model="createManualAppraisalForm.doi"
                        name="doi"
                        type="text"
                        class="form-control"
                        id="doi"
                      />
                    </div>
                    <div class="form-two-col">
                      <label for="database-select" class="form-label"
                        >Database</label
                      >
                      <select
                        v-model="createManualAppraisalForm.database"
                        name="database"
                        class="form-control"
                        id="database-select"
                      >
                        <option v-for="db in dbs" :value="db.name">
                          [[db.displayed_name]]
                        </option>
                      </select>
                    </div>
                  </div>

                  <div>
                    <label for="formFile" class="form-label">Full Text</label>
                    <file-uploader
                      id="full_text"
                      name="full_text"
                      drop-zone-image-url="{% static 'images/icons/download-icon.svg' %}"
                      edit-file-image-url="{% static 'images/icons/edit-icon.svg' %}"
                      :allowed-formats="['pdf',]"
                      :on-change="onNewAppraisalFileChanges"
                    >
                    </file-uploader>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="primary-button mr w-50">
                    Submit
                  </button>
                  <button
                    type="button"
                    class="secondary-gray-button w-50"
                    v-on:click="hideModal('createManualAppraisal')"
                  >
                    Cancel
                  </button>
                </div>
              </form>
              <div
                v-else-if="manualCreationMethod == 'select-previous'"
                class="previous-projects-container"
              >
                <label class="form-label"
                  >Please Select a Previous Project</label
                >
                <div v-if="reviews.length">
                  <custom-select
                    id="selected-prev-projects"
                    name="selected-prev-projects"
                    :options="projectOptions"
                    :default-selected="projectOptions[0]"
                    :on-change="onSelectPrevProjectChanged"
                  >
                  </custom-select>
                </div>
                <div v-else-if="!isRecordsLoading">
                  There are no previous projects.
                </div>
                <!-- loader section #2 -->
                <div class="update-loading-section-inside" id="loading-section">
                  <div class="update-loading-popup">
                    <div class="mb-3">
                      <img
                        src="{% static 'images/new_logo.svg' %}"
                        class="d-inline-block align-top"
                        alt="citemed-logo"
                      />
                    </div>

                    <div class="update-loading-popup-text">
                      Loading previous Appraisals from the selected Project,
                      please don't refresh the page Until the process is
                      completed! this process may take a few minutes.
                    </div>

                    <div class="update-loading-popup-progress">
                      <div></div>
                      <div></div>
                      <div></div>
                    </div>
                  </div>
                </div>
                <div
                  class="modal-body manual-creation-table-section"
                  id="manual-creation-table-section"
                >
                  <table class="custom-table" v-if="articleReviews.length">
                    <thead>
                      <tr>
                        <th style="width: 35px">
                          <input
                            type="checkbox"
                            name="check-article"
                            ref="checkAll"
                            v-model="isCheckAll"
                          />
                        </th>
                        <th style="width: 450px">Title</th>
                        <th>Abstract</th>
                        <th>Citation</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr
                        v-for="review in articleReviews"
                        :id="'review-'+review.id"
                        :key="review.id"
                      >
                        <td>
                          <input
                            type="checkbox"
                            name="check-article"
                            v-model="selectedReviews"
                            :value="review.id"
                          />
                        </td>

                        <td>
                          <a
                            v-on:click="onShowArticleDetails(review)"
                            class="exclude-link c-pointer"
                            :title="review.article.title"
                          >
                            [[ review.article.title ]]
                          </a>

                          <div
                            class="slider article-details-slider"
                            :id="'article-details-'+review.id"
                          >
                            <div class="slider-dialog">
                              <div class="slider-dialog-inner">
                                <div class="slider-header">
                                  <button
                                    v-on:click="hideArticleDetails(review)"
                                    class="pagintaion-item mr"
                                    type="button"
                                  >
                                    <svg
                                      width="16"
                                      height="16"
                                      viewBox="0 0 16 16"
                                      fill="none"
                                      xmlns="http://www.w3.org/2000/svg"
                                    >
                                      <path
                                        d="M10.0002 13.28L5.65355 8.93333C5.14022 8.42 5.14022 7.58 5.65355 7.06667L10.0002 2.72"
                                        stroke="#292D32"
                                        stroke-width="1.5"
                                        stroke-miterlimit="10"
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                      />
                                    </svg>
                                  </button>
                                  Detail View
                                </div>

                                <div v-if="currentArticle.selected">
                                  <div class="slider-content">
                                    <h2 class="mb-2">
                                      [[review.article.title]]
                                    </h2>
                                    <div class="center-v mb-2">
                                      <div class="litreview-icon">
                                        <img
                                          src="{% static 'images/icons/lit-review-icon-black.png' %}"
                                          alt="lit-review-icon"
                                        />
                                      </div>
                                      <div class="ml-2">
                                        <div class="center-v">
                                          <div>
                                            [[review.database.displayed_name]]
                                          </div>
                                          <a
                                            :href="review.database.url"
                                            class="db-link tooltip"
                                            target="_blank"
                                          >
                                            <div
                                              class="c-pointer ml"
                                              style="width: 14px"
                                              title="link to source"
                                            >
                                              <svg
                                                xmlns="http://www.w3.org/2000/svg"
                                                width="12"
                                                height="13"
                                                viewBox="0 0 12 13"
                                                fill="none"
                                                class="link-svg"
                                              >
                                                <path
                                                  d="M5.4375 2H3.1875C2.25552 2 1.5 2.75552 1.5 3.68749V9.31251C1.5 10.2445 2.25552 11 3.1875 11H8.8125C9.74448 11 10.5 10.2445 10.5 9.31251V7.06247M7.68722 2.00014L10.5 2M10.5 2V4.5313M10.5 2L5.71834 6.78109"
                                                  stroke="#9BA5B9"
                                                  stroke-linecap="round"
                                                  stroke-linejoin="round"
                                                />
                                              </svg>
                                            </div>
                                          </a>
                                        </div>
                                        <div
                                          v-if="review.database.is_ae || review.database.is_recall"
                                          class="hint"
                                        >
                                          Adverse Event
                                        </div>
                                        <div v-else class="hint">
                                          Clinical Literature
                                        </div>
                                      </div>
                                    </div>

                                    <div class="abstract hint mb-2">
                                      {% autoescape off %}
                                      <span
                                        v-if="review.processed_abstract"
                                        v-html="review.processed_abstract"
                                      >
                                      </span>
                                      <span
                                        v-else
                                        v-html="review.article.abstract"
                                      >
                                      </span>
                                      {% endautoescape %}
                                    </div>

                                    <div
                                      v-if="review.article.citation"
                                      class="info-card mb-2"
                                      v-html="review.article.citation"
                                    ></div>

                                    <div
                                      v-if="review.article.full_text"
                                      class="info-card mb-2"
                                    >
                                      <a
                                        class="center-v"
                                        :href="review.article.full_text"
                                        target="_blank"
                                      >
                                        <div class="file-download-icon mr">
                                          <svg
                                            width="22"
                                            height="22"
                                            viewBox="0 0 22 22"
                                            fill="none"
                                            xmlns="http://www.w3.org/2000/svg"
                                          >
                                            <g clip-path="url(#clip0_213_6862)">
                                              <path
                                                d="M4.46877 19.25L2.74658 17.5312H4.46877V19.25ZM17.5313 19.25L19.2535 17.5312H17.5313V19.25Z"
                                                fill="#A3313A"
                                              />
                                              <path
                                                d="M17.5312 4.46876H14.7847V1.7222L17.5312 4.46876Z"
                                                fill="#B2B2B2"
                                              />
                                              <path
                                                d="M14.7812 1.71875H5.01531C4.87036 1.71875 4.73133 1.77633 4.62883 1.87883C4.52633 1.98133 4.46875 2.12036 4.46875 2.26531V19.7966C4.46875 19.9418 4.52622 20.0812 4.62862 20.1843C4.73103 20.2873 4.87004 20.3457 5.01531 20.3466H16.9847C17.0581 20.3461 17.1307 20.331 17.1981 20.3021C17.2656 20.2732 17.3266 20.2311 17.3776 20.1782C17.4285 20.1254 17.4683 20.0628 17.4947 19.9943C17.5211 19.9258 17.5335 19.8527 17.5312 19.7794V4.46875H14.7812V1.71875Z"
                                                fill="#F1F1F1"
                                              />
                                              <path
                                                d="M3.09375 11.3438H18.9062C18.9974 11.3438 19.0849 11.38 19.1493 11.4444C19.2138 11.5089 19.25 11.5963 19.25 11.6875V17.5312H2.75V11.6875C2.75 11.5963 2.78622 11.5089 2.85068 11.4444C2.91515 11.38 3.00258 11.3438 3.09375 11.3438Z"
                                                fill="#C84D52"
                                              />
                                              <path
                                                d="M8.13672 14.8259V15.8125H7.44922V13.0006H8.54922C8.82664 12.9811 9.10063 13.0712 9.31234 13.2516C9.40371 13.3401 9.47471 13.4474 9.52042 13.5662C9.56613 13.6849 9.58544 13.8121 9.57703 13.9391C9.57883 14.1013 9.53856 14.2611 9.46016 14.4031C9.37963 14.5421 9.26012 14.6545 9.11641 14.7263C8.94171 14.8096 8.74954 14.8497 8.55609 14.8431L8.13672 14.8259ZM8.89297 13.9219C8.89297 13.6744 8.75547 13.5506 8.48047 13.5506H8.13672V14.2828H8.48047C8.75547 14.2828 8.89297 14.1625 8.89297 13.9219ZM12.2686 15.125C12.151 15.337 11.9742 15.5102 11.7598 15.6234C11.5189 15.7475 11.2505 15.809 10.9795 15.8022H9.91734V13.0006H10.9795C11.2501 12.9935 11.5183 13.0537 11.7598 13.1759C11.9749 13.2867 12.152 13.459 12.2686 13.6709C12.3892 13.8958 12.4496 14.148 12.4439 14.4031C12.447 14.6547 12.3867 14.9029 12.2686 15.125ZM11.5364 14.9841C11.6787 14.8193 11.7569 14.6088 11.7569 14.3911C11.7569 14.1734 11.6787 13.9629 11.5364 13.7981C11.3658 13.6495 11.1435 13.5742 10.9177 13.5884H10.598V15.1938H10.9177C11.1421 15.2109 11.3642 15.1393 11.5364 14.9944V14.9841ZM14.6645 13.0006V13.5438H13.5095V14.1591H14.3998V14.6747H13.5095V15.8125H12.822V13.0006H14.6645Z"
                                                fill="white"
                                              />
                                              <path
                                                d="M11.3092 3.61967C11.3345 3.85793 11.3111 4.09886 11.2404 4.3278C10.9345 5.38311 9.91013 9.22967 9.1367 9.77624C8.03326 10.56 7.4592 9.66967 8.04701 9.03717C8.63482 8.40467 12.1823 7.56249 13.3133 7.56249C14.7845 7.56249 14.5954 8.8653 13.7601 8.78624C12.8183 8.69686 10.4636 7.09155 10.3226 4.03905C10.2608 2.9528 11.2026 2.74999 11.3092 3.61967Z"
                                                stroke="#C84D52"
                                                stroke-miterlimit="10"
                                              />
                                            </g>
                                            <defs>
                                              <clipPath id="clip0_213_6862">
                                                <rect
                                                  width="22"
                                                  height="22"
                                                  fill="white"
                                                />
                                              </clipPath>
                                            </defs>
                                          </svg>
                                        </div>
                                        Article Full Text Click To Preview
                                      </a>
                                    </div>

                                    <div v-if="review.article.url" class="mt-2">
                                      <a
                                        :href="review.article.url"
                                        class="link primary-link"
                                        target="_blank"
                                      >
                                        View Source Link
                                      </a>
                                    </div>

                                    <div v-if="review.state_symbole === 'I'">
                                      <a
                                        :href="review.clinical_app_link"
                                        class="secondary-gray-button w-100 mt-2"
                                        target="_blank"
                                      >
                                        Clinical Appraisal Review
                                      </a>
                                    </div>

                                    <div
                                      v-if="review.article.keywords_list"
                                      class="mt-2"
                                    >
                                      <h4>Article Keywords</h4>
                                      <div class="abstract hint mt">
                                        <span
                                          v-for="kw in review.article.keywords_list"
                                        >
                                          [[kw]] ,
                                        </span>
                                      </div>
                                    </div>
                                  </div>
                                </div>

                                <div class="slider-footer">
                                  <button
                                    v-on:click="hideArticleDetails(review)"
                                    type="button"
                                    class="secondary-gray-button"
                                  >
                                    Cancel
                                  </button>
                                </div>
                              </div>
                            </div>
                          </div>
                        </td>

                        <td>
                          <div
                            :title="review.article.abstract"
                            v-html="truncateText(review.article.abstract)"
                          ></div>
                        </td>

                        <td>
                          <div
                            :title="review.article.citation"
                            v-html="truncateText(review.article.citation)"
                          ></div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  <p v-else>
                    No Appraisals Found - No articles has been retained yet
                  </p>
                </div>
                <div class="modal-footer" v-if="articleReviews.length">
                  <button
                    class="primary-button mr w-50"
                    v-on:click="importManualSearch()"
                    :disabled="isManualCitationsFromPreviousProjectsLoading"
                  >
                    import into current project as Manual Search
                  </button>
                  <button
                    type="button"
                    class="secondary-gray-button w-50"
                    v-on:click="hideModal('createManualAppraisal')"
                  >
                    Cancel
                  </button>
                </div>
                <div class="modal-footer" v-else>
                  <button
                    type="button"
                    class="secondary-gray-button w-100"
                    v-on:click="hideModal('createManualAppraisal')"
                  >
                    Cancel
                  </button>
                </div>
              </div>
              <div v-else class="modal-footer">
                <button
                  type="button"
                  class="secondary-gray-button w-100"
                  v-on:click="hideModal('createManualAppraisal')"
                >
                  Cancel
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="modal" id="upload-own-searches">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <div class="modal-header-icon-wrapper info-icon">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="14"
                    height="14"
                    viewBox="0 0 14 14"
                    fill="none"
                  >
                    <path
                      d="M7.04898 11.6323H2.8007C2.0275 11.6323 1.4007 11.0055 1.4007 10.2322L1.40076 4.90974C1.40076 4.37661 1.40056 3.61727 1.40039 3.06745C1.40027 2.68075 1.71372 2.36763 2.10042 2.36763H5.43604L7.04898 4.09058H11.9002C12.2868 4.09058 12.6002 4.40399 12.6002 4.79058V6.65M11.5502 10.85L12.2502 11.55M11.9002 9.45C11.9002 10.4165 11.1167 11.2 10.1502 11.2C9.18366 11.2 8.40016 10.4165 8.40016 9.45C8.40016 8.4835 9.18366 7.7 10.1502 7.7C11.1167 7.7 11.9002 8.4835 11.9002 9.45Z"
                      stroke="#181A1E"
                      stroke-width="1.2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </div>
                <div class="center-v">Import Your Own Citations</div>
                <div class="hint mt">
                  Want to upload your own searches from a RIS file? You can do
                  it directly here without creating a search term.
                </div>
              </div>
              <div class="modal-body validate-seaerch-body">
                <h3 class="mt-2 mb">Please select a database</h3>
                <div v-if="dbOptions.length">
                  <custom-select
                    id="select-own-search-database"
                    name="select-own-search-database"
                    :options="dbOptions"
                    :default-selected="dbOptions[0]"
                    :on-change="onUploadCitationsDbChanged"
                  >
                  </custom-select>
                </div>

                <div v-if="uploadOwnCitationsForm.database === 'external'">
                  <label for="external_db_name"> External Database Name </label>
                  <input
                    v-model="uploadOwnCitationsForm.external_db_name"
                    name="external_db_name"
                    type="text"
                    id="external_db_name"
                  />
                  <label for="external_db_url" class="mt">
                    External Database URL
                  </label>
                  <input
                    v-model="uploadOwnCitationsForm.external_db_url"
                    name="external_db_url"
                    type="text"
                    id="external_db_url"
                  />
                </div>

                <div class="mt-2" v-if="isUploadCitaionModalOpen">
                  <file-uploader
                    id="upload-own-citation-file"
                    drop-zone-image-url="{% static 'images/icons/download-icon.svg' %}"
                    edit-file-image-url="{% static 'images/icons/edit-icon.svg' %}"
                    :allowed-formats="['ris']"
                    name="upload-own-citation-file"
                    :on-change="onUploadCitationsFileChanged"
                  >
                  </file-uploader>
                </div>

                <button
                  type="submit"
                  class="primary-button center-v w-100 mt-2"
                  v-on:click="onUploadOwnCitations"
                  :disabled="isUploadOwnCitationsLoading"
                  :class="{ loading: isUploadOwnCitationsLoading }"
                >
                  <div class="center-v w-100 w-max m-auto">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="17"
                      height="17"
                      viewBox="0 0 17 17"
                      fill="none"
                    >
                      <path
                        d="M14.5 8.5C14.5 11.8137 11.8137 14.5 8.5 14.5C5.18629 14.5 2.5 11.8137 2.5 8.5C2.5 5.18629 5.18629 2.5 8.5 2.5C9.44137 2.5 10.3321 2.71679 11.125 3.10317M13.375 4.75L8.125 10L6.625 8.5"
                        stroke="white"
                        stroke-width="1.2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                    <span class="ml"> Upload Citations </span>
                  </div>
                </button>

                <div class="horizantal-devider mt-2 mb-2"></div>
                <div class="hint mt-2">
                  Need help on how to perform a manual search on the database
                  and download the results file? Please check out our
                  <a
                    href="https://citemedical.notion.site/Running-Manual-Searches-on-the-CiteMed-App-83bfe99fb6b9408eb45c67eb13d996e0#732998356ab34de9a5c93c535cdb114c"
                    target="_blank"
                    class="primary-link"
                  >
                    Wiki Instructions </a
                  >.
                </div>
              </div>
              <div class="modal-footer">
                <button
                  class="secondary-gray-button w-100"
                  v-on:click="hideModal('upload-own-searches')"
                  type="button"
                >
                  Close
                </button>
              </div>
            </div>
          </div>
        </div>

        <!--  Hide AI buttions from prod public environement -->
        {% if SHOW_AI_BETA %}
        <!-- AI Extract All Texts -->
        <button
          class="primary-button ml-auto"
          style="display: flex;"
          @click="autoGenerateAllExtractionFields"
          :disabled="isArchived"
        >
          <img
            class="header-right-icon"
            src="{% static 'images/icons/ai-icon.svg' %}"
            alt="show-pdf-file-icon"
            srcset=""
          />
          <span> Run AI Extractions For All Articles </span>
        </button>
        {% endif %}
      </div>

      <div v-if="isLoading">
        <loader header-text="Loading Results..." />
      </div>
      <table v-else-if="appraisals.length" class="custom-table">
        <thead>
          <tr>
            <th scope="col" id="id" style="width: 80px"># ID</th>
            <th scope="col" style="cursor: default">
              <div class="center-v">
                <div
                  v-on:click="onSortRecords('article_review__article__title')"
                  class="center-v c-pointer sub-table-header"
                >
                  <span class="tooltip-elt" title="Sort by the title">
                    Title <img src="{% static 'images/icons/filter.png' %}" />
                  </span>
                </div>
                <div
                  v-on:click="onSortRecords('article_review__article__meta_data__authors')"
                  class="center-v ml-2 c-pointer sub-table-header"
                >
                  <span class="tooltip-elt" title="Sort by the authors name">
                    Authors <img src="{% static 'images/icons/filter.png' %}" />
                  </span>
                </div>
              </div>
            </th>
            <th
              scope="col"
              v-on:click="onSortRecords('is_sota_article')"
              style="width: 120px"
              class="c-pointer"
            >
              Is Sota <img src="{% static 'images/icons/filter.png' %}" />
            </th>
            <th
              scope="col"
              v-on:click="onSortRecords('app_status')"
              style="width: 250px"
              class="c-pointer"
            >
              Status <img src="{% static 'images/icons/filter.png' %}" />
            </th>
          </tr>
        </thead>
        <tbody>
          <tr v-for="appraisal in appraisals">
            <td>#[[appraisal.id]]</td>
            <td>
              <a :href="appraisal.details_url+createURLParams()" class="link">
                <span style="font-weight: bold"> [[appraisal.title]] </span>
                <span class="icon ml">
                  <svg
                    class="link-svg"
                    xmlns="http://www.w3.org/2000/svg"
                    width="12"
                    height="13"
                    viewBox="0 0 12 13"
                    fill="none"
                  >
                    <path
                      d="M5.4375 2H3.1875C2.25552 2 1.5 2.75552 1.5 3.68749V9.31251C1.5 10.2445 2.25552 11 3.1875 11H8.8125C9.74448 11 10.5 10.2445 10.5 9.31251V7.06247M7.68722 2.00014L10.5 2M10.5 2V4.5313M10.5 2L5.71834 6.78109"
                      stroke="#9BA5B9"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </span>
              </a>
              <div class="info-card mt">Authors: [[ appraisal.authors ]]</div>
            </td>
            <td>
              <div
                v-if="appraisal.is_sota_article"
                class="badge success badge-icon m-auto"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                >
                  <path
                    d="M16.8002 8.3999L9.64068 15.5999L7.2002 13.1456"
                    stroke="#21BD62"
                    stroke-width="1.2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </div>
              <div v-else class="badge error badge-icon m-auto">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                >
                  <path
                    d="M18 6L6 18M18 18L6 6"
                    stroke="#FB6514"
                    stroke-width="1.2"
                    stroke-linecap="round"
                  />
                </svg>
              </div>
            </td>
            <td>
              <div
                class="badge"
                :class="appraisal.app_status === 'Complete' ? 'success' : appraisal.app_status === 'Incomplete Extraction Fields' ? 'warning' : 'error'"
              >
                [[ capitalizeWords(appraisal.app_status) ]]
              </div>
            </td>
          </tr>
        </tbody>
      </table>

      <p class="badge warning no-results" v-else>
        No Appraisals - have any articles been retained?
      </p>

      <div v-if="appraisals.length && pagination.current" class="table-footer">
        <div class="left-section"></div>
        <div class="middle-section">
          <div class="pagination">
            <a
              v-if="pagination.previous"
              v-on:click="loadRecords(pagination.previous)"
              class="pagintaion-item"
            >
              <svg
                width="16"
                height="16"
                viewBox="0 0 16 16"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M10.0002 13.28L5.65355 8.93333C5.14022 8.42 5.14022 7.58 5.65355 7.06667L10.0002 2.72"
                  stroke="#292D32"
                  stroke-width="1.5"
                  stroke-miterlimit="10"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </a>

            <a
              v-for="page in pagination.page_range"
              v-if="page && page <= pagination.last"
              v-on:click="loadRecords(page)"
              class="pagintaion-item"
              :class="page === pagination.current ? 'selected' : ''"
              href="?sorting={{current_sorting}}&search_title={{search_title}}{% for status in filter_status%}&filter_status={{status}}{% endfor %}&appraisal_page={{ num }}"
            >
              [[page]]
            </a>

            <a
              v-if="pagination.next"
              v-on:click="loadRecords(pagination.next)"
              class="pagintaion-item"
            >
              <svg
                width="16"
                height="16"
                viewBox="0 0 16 16"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M5.93994 13.28L10.2866 8.93333C10.7999 8.42 10.7999 7.58 10.2866 7.06667L5.93994 2.72"
                  stroke="#292D32"
                  stroke-width="1.5"
                  stroke-miterlimit="10"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </a>
          </div>
        </div>
        <div class="right-section">[[ tablePageIndicator ]]</div>
      </div>
    </div>

    <div class="appraisals-insights" :class="collapsedInsights ? '' : 'active'" ref="appraisals-insights">
      <div class="insight-item header">
          <div class="sidebar-right-top-left-side center-v">
            <div class="icon-section c-pointer" v-on:click="collapseMenu">
              <img style="width: 20px;"
                src="{% static 'images/icons/collapse-icon.svg' %}"
                alt="directory icon"
                :class="!collapsedInsights ? '' : 'collapse-icon-rotate'"
              />
            </div>
            <div v-if="!collapsedInsights">
              <h3 class="history-title ml">
                Insights
              </h3>
            </div>
          </div>
      </div>
      
      <div class="horizantal-devider mt-2 mb-2"></div>

      <div v-if="!collapsedInsights && appraisalsInsights">
        <div class="insight-item header">
          <div>All Appraisals</div>
          <div class="badge info">
            [[ appraisalsInsights['Total'] ]]
          </div>
        </div>

        <div class="horizantal-devider mt-2 mb-2"></div>

        <div class="insight-item header">
          <div>Completed</div>
          <div class="badge success">
            [[ appraisalsInsights['Complete'] ]]
          </div>
        </div>

        <div class="insight-item">
          <div>Complete Sota Reviews</div>
          <div class="badge success">
            [[ appraisalsInsights['Complete SoTa Reviews'] ]]
          </div>
        </div>

        <div class="insight-item">
          <div>Complete Device Reviews</div>
          <div class="badge success">
            [[ appraisalsInsights['Complete Device Reviews'] ]]
          </div>
        </div>

        <div class="horizantal-devider mt-2 mb-2"></div>

        <div class="insight-item header">
          <div>Uncompleted</div>
          <div class="badge error">
            [[ appraisalsInsights['Uncomplete'] ]]
          </div>
        </div>

        <div class="insight-item">
          <div>Incomplete Extraction Fields</div>
          <div class="badge warning">
            [[ appraisalsInsights['Incomplete Extraction Fields'] ]]
          </div>
        </div>

        <div class="insight-item">
          <div>Missing Full Text Pdf/Incomplete</div>
          <div class="badge error">
            [[ appraisalsInsights['Missing full text pdf/Incomplete'] ]]
          </div>
        </div>

        <div class="insight-item">
          <div>Full Text Uploaded/Ready For Review</div>
          <div class="badge error">
            [[ appraisalsInsights['Full text uploaded/Ready for Review']
            ]]
          </div>
        </div>

        <div class="insight-item">
          <div>Needs Suitability/Outcomes Dropdowns</div>
          <div class="badge error">
            [[ appraisalsInsights['Needs Suitability/Outcomes Dropdowns'] ]]
          </div>
        </div>

        <div class="insight-item">
          <div>Incomplete Sota</div>
          <div class="badge error">
            [[ appraisalsInsights['Incomplete Sota'] ]]
          </div>
        </div>

        <div class="insight-item">
          <div>Incomplete Device Review</div>
          <div class="badge error">
            [[ appraisalsInsights['Incomplete Device Review'] ]]
          </div>
        </div>

        <div class="insight-item">
          <div>Missing Excl. Justification</div>
          <div class="badge error">
            [[ appraisalsInsights['Missing Excl. Justification'] ]]
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %} {% block 'scripts-block' %}
<script type="application/javascript">
  const clinicalAppraisalsListURL =
    "{% url 'lit_reviews:clinical-appraisals-list-api' id=literature_review_id %}";
  const appraisalsDataURL =
    "{% url 'lit_reviews:appraisals_data_api' id=literature_review_id %}";
  const CheckRunningCitationURL =
    "{% url 'literature_reviews:check_running_citation_api' id=literature_review_id %}";
  const uploadCitationsAPI =
    "{% url 'literature_reviews:upload_clinical_appraisals_citations_api' id=literature_review_id %}";
  const S3DirectUploadURL =
    "{% url 'literature_reviews:generate_s3_url' id=literature_review_id %}";
  const ArticleReviewHistoryAPI =
    "{% url 'lit_reviews:article_review_history' id=literature_review_id review_id=0 %}";
  const ImportManualSearchURL =
    "{% url 'literature_reviews:import_manual_search' id=literature_review_id %}";
  const AppraisalAIAllDataURL =
    "{% url 'lit_reviews:process-all-appraisals' id=literature_review_id %}";
  const CreateManualAppraisalURL =
    "{% url 'lit_reviews:create-manual-appraisal-api' id=literature_review_id %}";

  const maxResults = "{{max_results}}";
</script>
<script
  type="application/javascript"
  src="{% static 'lit_reviews/vue/appraisals.js' %}"
></script>

{% endblock %}
